import sqlite3
import hashlib

def validar_login(email, senha):
    # Criptografa a senha antes de comparar
    senha_hash = hashlib.sha256(senha.encode()).hexdigest()

    # Consulta segura com parâmetros (evita SQL Injection)
    query = "SELECT * FROM usuarios WHERE email = ? AND senha = ?"

    conn = sqlite3.connect('database.db')
    cursor = conn.cursor()
    cursor.execute(query, (email, senha_hash))
   
    usuario = cursor.fetchone()
    conn.close()

    if usuario:
        # Removido o print com dados sensíveis
        return True
    return False

